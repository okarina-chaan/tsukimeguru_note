<section class="mt-6 rounded-2xl bg-gradient-to-br from-base-100/15 to-base-100/5 backdrop-blur-sm border border-base-content/15 hover:border-base-content/25 transition-colors duration-300 shadow-md shadow-base-content/5">
  <div class="px-6 py-5">
    <div class="flex items-center gap-3 mb-4">
      <h3 class="text-sm font-semibold text-base-content/90">今週の変化</h3>

      <% if current_user.weekly_insight_available? %>
          <%= button_to "今週の変化をみる",
            weekly_insight_analysis_path,
            data: { method: :post },
            class: "btn btn-sm btn-outline btn-primary rounded-full px-5 tracking-wide hover:shadow-md hover:shadow-primary/20" %>
      <% else %>
      <button
        class="btn btn-sm btn-outline btn-primary rounded-full px-5 tracking-wide opacity-60"
        disabled>
        今週の変化をみる
      </button>
    
      <p class="mt-2 text-xs text-base-content/60 cursor-not-allowed">
          次の更新は <%= Time.zone.now.next_week(:monday).strftime('%Y-%m-%d') %> です
      </p>
      <% end %>

    </div>


    <% if insight.present? %>
      <div class="relative pl-5 py-3 before:content-[''] before:absolute before:left-0 before:top-0 before:bottom-0 before:w-1 before:rounded-full before:bg-gradient-to-b before:from-primary/60 before:to-primary/20">
        <p class="text-sm text-base-content/85 leading-relaxed whitespace-pre-line">
          <%= insight %>
        </p>
      </div>
    <% else %>
      <div class="flex items-start gap-3 py-3 px-4 rounded-xl bg-base-content/5">
        <p class="text-sm text-base-content/45 leading-relaxed">
          今週の記録が集まると、ここに変化が表示されます。
        </p>
      </div>
    <% end %>

  </div>
</section>
