Table users {
  id integer [pk]
  line_user_id string [not null, unique, note: 'LINEのユーザー識別子']
  name string [note: 'LINEの表示名']
  account_resistered boolean [default: false, note: 'アカウント登録済みかどうか']
  weekly_insight_generated_at datetime [note: '週毎の振り返りを最後に生成した日時']
  created_at datetime
  updated_at datetime
}

Table daily_notes {
  id bigint [pk]
  user_id bigint [ref: > users.id]
  date date [not null]
  condition_score int [note: '体調']
  mood_score int [note: '気分']
  did_today string [ note: '今日やったこと']
  challenges string [ note: '今日できなかったこと、伸びしろポイント']
  good_things string [ note: '今日あった感謝や嬉しかったこと']
  try_tomorrow string [ note: '明日やってみたいこと']
  note text [ note: '自由記述メモ']
  moon_phase_name string [ note: 'APIから取った月相']
  created_at datetime
  updated_at datetime
}

Table moon_notes {
  id integer [pk]
  user_id integer [ref: > users.id]
  moon_phase_id integer [ref: > moon_phases.id]
  content text [note: '記録本文']
  created_at datetime
  updated_at datetime
}

Table moon_profiles {
  id integer [pk]
  user_id integer [ref: > users.id]
  moon_sign_id integer [ref: > moon_signs.id]
  birth_date date
  birth_time time
  birth_place string
  created_at datetime
}

Table moon_signs {
  id integer [pk]
  name string	[note: '英語名']
  name_ja	string	[note: '日本語名']
  description	text	[note: '解説文']
  created_at datetime
  updated_at	datetime
}

Table moon_phases {
  id integer [pk]
  date date [unique]
  moon_age float [note: '月齢']
  name string [note: '新月／満月／上弦／下弦']
  moon_sign string [note: 'その日の月星座']
  message text [note: '月齢に応じたメッセージ']
  created_at datetime
}

Table moon_messages {
  id integer [pk]
  moon_phase_name string [not null, note: '月相（新月／満月／上弦／下弦）']
  title string [note: 'メッセージタイトル（任意）']
  content text [note: '通知メッセージ本文']
  send_hour integer [note: '送信時刻']
  is_active boolean [default: true, note: '通知を有効にするかどうか']
  created_at datetime
  updated_at datetime
}


Table line_message_logs {
  id integer [pk]
  user_id integer [ref: > users.id]
  moon_message_id integer [ref: > moon_messages.id]
  status string [note: '送信ステータス (success/fail)']
  sent_at datetime
}

Table user_moon_message_settings {
  id integer [pk]
  user_id integer [ref: > users.id]
  moon_phase_name string [not null, note: '月相（新月／満月／上弦／下弦）']
  is_enabled boolean [default: false, note: 'この月相の通知を受け取るか']
  preferred_hour integer [note: '通知を受けたい時刻']
  created_at datetime
  updated_at datetime
}
